<html lang="en" xmlns:th="http://www.thymeleaf.org">


<section class="py-5" th:fragment="product">
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-12">
				<div class="bootstrap-tabs product-tabs">
					<div class="tabs-header d-flex justify-content-between border-bottom my-5">
						<h3>Sản phẩm hot</h3>

						<!--<div class="dropdown">
							<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
								data-bs-toggle="dropdown" aria-expanded="false">
								Danh mục sản phẩm
							</button>
							<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
								<li><a class="dropdown-item" href="/products/all">Tất cả</a></li>
								
								<li th:each="category : ${danhMucs}">
									<a class="dropdown-item" th:href="@{'#' + ${category.maDanhMuc}}"
										th:text="${category.tenDanhMuc}">Tên danh mục</a>
										
									
										
										
								</li>
							</ul>
						</div>-->

						<nav>
							<div class="nav nav-tabs d-flex" id="nav-tab" role="tablist">
								<!-- Tab "Tất cả" -->
								<a href="#nav-all" class="nav-link text-uppercase fs-6 active" id="nav-all-tab"
									data-bs-toggle="tab" role="tab">Tất cả</a>

								<!-- Hiển thị một số danh mục chính -->
								<span th:each="category, iterStat : ${danhMucs}">
									<a th:if="${iterStat.index < 4}" href="#" class="nav-link text-uppercase fs-6"
										th:id="'nav-' + ${category.maDanhMuc} + '-tab'"
										th:data-bs-target="'#nav-' + ${category.maDanhMuc}"
										th:text="${category.tenDanhMuc}" data-bs-toggle="tab" role="tab">
									</a>
								</span>

								<!-- Dropdown cho các danh mục còn lại -->
								<div class="nav-item dropdown" th:if="${danhMucs != null and danhMucs.size() > 4}">
									<a class="nav-link dropdown-toggle text-uppercase fs-6" href="#"
										id="dropdownMenuLink" role="button" data-bs-toggle="dropdown"
										aria-expanded="false">
										Danh mục khác
									</a>
									<ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
										<li th:each="category, iterStat : ${danhMucs}">
											<!--<a href="#" class="dropdown-item"
												th:each="category : ${danhMucs}"
												th:id="'nav-' + ${category.maDanhMuc} + '-tab'"
												th:data-bs-target="'#nav-' + ${category.maDanhMuc}"
												th:text="${category.tenDanhMuc}" data-bs-toggle="tab" role="tab">
											</a>-->
											<a th:if="${iterStat.index >= 4}" class="dropdown-item"
												th:href="'#nav-' + ${category.maDanhMuc}" th:data-bs-toggle="tab"
												th:attr="data-bs-target='#nav-' + ${category.maDanhMuc}"
												th:text="${category.tenDanhMuc}">
											</a>
										</li>
									</ul>
								</div>
							</div>
						</nav>


						<!--<nav>
							<div class="nav nav-tabs" id="nav-tab" role="tablist">
								
								<a href="#" class="nav-link text-uppercase fs-6 active" id="nav-all-tab"
									data-bs-toggle="tab" data-bs-target="#nav-all" role="tab">Tất cả</a>

								
								<a href="#" class="nav-link text-uppercase fs-6" 
									th:each="category : ${danhMucs}"
									th:id="'nav-' + ${category.maDanhMuc} + '-tab'"
									th:data-bs-target="'#nav-' + ${category.maDanhMuc}" th:text="${category.tenDanhMuc}"
									data-bs-toggle="tab" role="tab">
								</a>
							</div>
						</nav>-->


						<!--<nav>
							<div class="nav nav-tabs" id="nav-tab" role="tablist">

								<a href="#" class="nav-link text-uppercase fs-6 active" id="nav-all-tab"
									data-bs-toggle="tab" data-bs-target="#nav-all">Tất cả</a>

								<a href="#" class="nav-link text-uppercase fs-6" th:each="category : ${visibleDanhMucs}"
									th:id="'nav-' + ${category.maDanhMuc} + '-tab'"
									th:data-bs-target="'#nav-' + ${category.maDanhMuc}" th:text="${category.tenDanhMuc}"
									data-bs-toggle="tab">
								</a>
							</div>
						</nav>-->






					</div>

					<div class="tab-content" id="nav-tabContent">
						<!-- Hiển thị tất cả sản phẩm -->
						<div class="tab-pane fade show active" id="nav-all" role="tabpanel"
							aria-labelledby="nav-all-tab">
							<div
								class="product-grid row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5">
								<!-- Lặp qua tất cả các sản phẩm và hiển thị -->
								<div class="col" th:each="sanPham : ${sanPhams}" style="min-height: 350px; 
									
									
							            display: flex; 
							            flex-direction: column; 
							            justify-content: space-between; 
							            transition: transform 0.2s ease, box-shadow 0.3s ease; 
							            
							            border-radius: 30px; /* Bo góc 10px */
							            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Đổ bóng nhẹ ban đầu */
							            background-color: #fff;"
									onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 16px rgba(0, 0, 0, 0.3)';"
									onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 6px rgba(0, 0, 0, 0.1)';">
									<div class="product-item" style="flex-grow: 1;">

										<!-- Badge Khuyến mãi -->
										<span class="badge bg-success position-absolute m-3"
											th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
											th:text="'-' + ${sanPhamKhuyenMaiMap[sanPham.maSanPham].phanTramGiamGia} + '%'">
										</span>

										<a href="#" class="btn-wishlist">
											<svg width="24" height="24">
												<use xlink:href="#heart"></use>
											</svg>
										</a>
										<figure th:if="${sanPham != null}">
											<a th:href="@{'/product/' + ${sanPham.maSanPham}}"
												th:title="${sanPham.tenSanPham}">
												<img th:src="@{'/upload/' + ${sanPham.hinhAnh}}" class="tab-image"
													alt="Sản phẩm">
											</a>
										</figure>
										<h3 th:text="${sanPham.tenSanPham}">Tên sản phẩm</h3>
										<span class="qty" th:text="${sanPham.donViTinh.tenDonVi}">Đơn vị tính</span>
										<!--<span class="price" th:text="${sanPham.donGiaBan} + ' VND'">Giá sản phẩm</span>-->
										<!-- Hiển thị giá -->
										<div>

											<!-- Nếu có khuyến mãi, hiển thị giá gốc gạch ngang -->
											<span
												style="font-size: 12px; color: red; text-decoration: line-through; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
												th:text="${sanPham.donGiaBan} + ' VND'">
											</span>

											<!-- Nếu có khuyến mãi và giá sau giảm không null -->
											<span
												style="font-size: 18px; color: black; font-weight: bold; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
												th:text="${sanPhamGiaSauGiamMap[sanPham.maSanPham]} + ' VND'">
											</span>



											<!-- Nếu không có khuyến mãi hoặc không tính được giá sau giảm, hiển thị giá gốc -->
											<span
												style="font-size: 18px; color: black; font-weight: bold; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] == null}"
												th:text="${sanPham.donGiaBan} + ' VND'">
											</span>

										</div>

										<!-- Số lượng sản phẩm và nút thêm vào giỏ hàng -->
										<div
											class="product-quantity-container d-flex justify-content-center align-items-center mt-3">
											<label for="quantity" class="form-label me-2"></label>

											<!-- Ô nhập số lượng -->
											<input type="number" id="quantity" name="quantity" value="1" min="1"
												class="form-control quantity-input me-3" style="width: 50px;
									border: 2px solid #000;"
									 oninput="if(this.value < 1) this.value = 1;">

											<!-- Nút thêm vào giỏ hàng -->
											<button
												class="btn btn-warning add-to-cart d-flex align-items-center justify-content-center"
												style="background-color: #fca503; color: #fff; border: none; transition: background-color 0.3s ease;"
												onmouseover="this.style.backgroundColor='#e68a00';"
												onmouseout="this.style.backgroundColor='#fca503';">
												<span class="iconify" data-icon="uil:shopping-cart" data-inline="false"
													style="font-size: 1.5rem; margin-right: 5px;"></span>
											</button>

										</div>
									</div>
								</div>
							</div>
						</div>
						<!--
							phân trang
							<div class="pagination-container">
							<nav aria-label="Page navigation">
								<ul class="pagination justify-content-center">
									<li class="page-item">
										<a class="page-link"
											th:href="@{'?page=' + (${currentPage - 1}) + '#pagination'}"
											aria-label="Previous">&laquo;</a>
									</li>
									<li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
										<a class="page-link" th:href="@{'?page=' + ${i} + '#pagination'}"
											th:text="${i + 1}">1</a>
									</li>
									<li class="page-item">
										<a class="page-link"
											th:href="@{'?page=' + (${currentPage + 1}) + '#pagination'}"
											aria-label="Next">&raquo;</a>
									</li>
								</ul>
							</nav>
						</div>-->

						<!-- Hiển thị sản phẩm theo từng danh mục -->
						<!--<div class="tab-pane fade" th:each="category : ${visibleDanhMucs}"-->
						<div class="tab-pane fade" th:each="category : ${danhMucs}"
							th:id="'nav-' + ${category.maDanhMuc}" role="tabpanel"
							th:aria-labelledby="'nav-' + ${category.maDanhMuc} + '-tab'">
							<div
								class="product-grid row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5">
								<div class="col" th:each="sanPham : ${category.sanPhams}" 
								th:if="${sanPham.trangThai == true 
								  and !sanPham.chiTietDonNhapHangs.isEmpty()
								
								  and sanPham.chiTietDonNhapHangs.?[donNhapHang.tongGiaTriNhapHang > 0 
								  and soLuongNhap > 0 and donGiaNhap > 0].size() > 0}" style="min-height: 350px; 
									
									
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; 
            transition: transform 0.2s ease, box-shadow 0.3s ease; 
            
            border-radius: 30px; /* Bo góc 10px */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Đổ bóng nhẹ ban đầu */
            background-color: #fff;"
									onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 16px rgba(0, 0, 0, 0.3)';"
									onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 6px rgba(0, 0, 0, 0.1)';">



									<div class="product-item" style="flex-grow: 1;">
										<!-- Badge Khuyến mãi -->
										<span class="badge bg-success position-absolute m-3"
											th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
											th:text="'-' + ${sanPhamKhuyenMaiMap[sanPham.maSanPham].phanTramGiamGia} + '%'">
										</span>

										<a href="#" class="btn-wishlist">
											<svg width="24" height="24">
												<use xlink:href="#heart"></use>
											</svg>
										</a>
										<figure th:if="${sanPham != null}">
											<a th:href="@{'/product/' + ${sanPham.maSanPham}}"
												th:title="${sanPham.tenSanPham}">
												<img th:src="@{'/upload/' + ${sanPham.hinhAnh}}" class="tab-image"
													alt="Sản phẩm">
											</a>
										</figure>
										<h3 th:text="${sanPham.tenSanPham}">Tên sản phẩm</h3>
										<span class="qty" th:text="${sanPham.donViTinh.tenDonVi}">Đơn vị tính</span>
										<!--<span class="price" th:text="${sanPham.donGiaBan} + ' VND'">Giá sản phẩm</span>-->
										<!-- Hiển thị giá -->
										<div>
											<!-- Nếu có khuyến mãi, hiển thị giá gốc gạch ngang -->
											<span
												style="font-size: 12px; color: red; text-decoration: line-through; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
												th:text="${sanPham.donGiaBan} + ' VND'">
											</span>

											<!-- Nếu có khuyến mãi và giá sau giảm không null -->
											<span
												style="font-size: 18px; color: black; font-weight: bold; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
												th:text="${sanPhamGiaSauGiamMap[sanPham.maSanPham]} + ' VND'">
											</span>

											<!-- Nếu không có khuyến mãi, hiển thị giá gốc -->
											<span
												style="font-size: 18px; color: black; font-weight: bold; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] == null}"
												th:text="${sanPham.donGiaBan} + ' VND'">
											</span>
										</div>


										<!--<div class="d-flex align-items-center justify-content-between">
											<div class="input-group product-qty">
												<span class="input-group-btn">
													<button type="button"
														class="quantity-left-minus btn btn-danger btn-number"
														data-type="minus">
														<svg width="16" height="16">
															<use xlink:href="#minus"></use>
														</svg>
													</button>
												</span>
												<input type="text" id="quantity" name="quantity"
													class="form-control input-number" value="1">
												<span class="input-group-btn">
													<button type="button"
														class="quantity-right-plus btn btn-success btn-number"
														data-type="plus">
														<svg width="16" height="16">
															<use xlink:href="#plus"></use>
														</svg>
													</button>
												</span>
											</div>
											<a href="#" class="nav-link d-flex align-items-center">
												<span style="font-size: 12px;">Thêm vào giỏ hàng </span>
												<span class="iconify" data-icon="uil:shopping-cart" data-inline="false"
													style="font-size: 30px;color: #ff0000;"></span>
												
											</a>


										</div>-->
										<!-- Số lượng sản phẩm và nút thêm vào giỏ hàng -->
										<div
											class="product-quantity-container d-flex justify-content-center align-items-center mt-3">
											<label for="quantity" class="form-label me-2"></label>

											<!-- Ô nhập số lượng -->
											<input type="number" id="quantity" name="quantity" value="1" min="1"
												class="form-control quantity-input me-3" style="width: 50px;
									border: 2px solid #000;"
									 oninput="if(this.value < 1) this.value = 1;">

											<!-- Nút thêm vào giỏ hàng -->
											<button
												class="btn btn-warning add-to-cart d-flex align-items-center justify-content-center"
												style="background-color: #fca503; color: #fff; border: none; transition: background-color 0.3s ease;"
												onmouseover="this.style.backgroundColor='#e68a00';"
												onmouseout="this.style.backgroundColor='#fca503';">
												<span class="iconify" data-icon="uil:shopping-cart" data-inline="false"
													style="font-size: 1.5rem; margin-right: 5px;"></span>
											</button>

										</div>





									</div>
								</div>
							</div>
						</div>
						<!-- Phân trang chung -->
						<!--<div class="pagination-container">
							<nav aria-label="Page navigation">
								<ul class="pagination justify-content-center">
									<li class="page-item" th:if="${currentPage > 0}">
										<a class="page-link"
											th:href="@{${currentCategory != null} ? '/?maDanhMuc=' + ${currentCategory} + '&page=' + (${currentPage - 1}) : '/?page=' + (${currentPage - 1})}"
											aria-label="Previous">&laquo;</a>
									</li>
									<li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
										<a class="page-link"
											th:href="@{${currentCategory != null} ? '/?maDanhMuc=' + ${currentCategory} + '&page=' + ${i} : '/?page=' + ${i}}"
											th:text="${i + 1}"></a>
									</li>
									<li class="page-item" th:if="${currentPage < totalPages - 1}">
										<a class="page-link"
											th:href="@{${currentCategory != null} ? '/?maDanhMuc=' + ${currentCategory} + '&page=' + (${currentPage + 1}) : '/?page=' + (${currentPage + 1})}"
											aria-label="Next">&raquo;</a>
									</li>
								</ul>
							</nav>
						</div>-->

					</div>

				</div>
			</div>
		</div>
	</div>

</section>


<style>
	.price {
		font-size: 10px;
		/* Kích thước mặc định cho giá */
		font-weight: bold;
		color: black;
		/* Màu đen cho giá chính */
	}

	.text-danger {
		font-size: 15px;
		/* Kích thước lớn hơn cho giá đã giảm */
		font-weight: bold;
		color: black;
		/* Đổi lại màu đen cho giá sau giảm */
	}

	.text-muted {
		font-size: 6px;
		/* Kích thước nhỏ hơn cho giá gốc */
		color: red;
		/* Màu đỏ cho giá gốc */
		text-decoration: line-through;
		/* Gạch ngang cho giá gốc */
		display: block;
		margin-bottom: 5px;
		/* Khoảng cách giữa giá gốc và giá sau khi giảm */
	}


	/* CSS để đảm bảo các khung sản phẩm đồng đều */
	.product-item {
		display: flex;
		flex-direction: column;
		justify-content: space-between;
		height: 100%;
		/* Đảm bảo khung sản phẩm bao phủ toàn bộ chiều cao */
		border: 1px solid #ddd;
		padding: 10px;
		box-sizing: border-box;
		border-radius: 10px;
		transition: transform 0.3s ease, box-shadow 0.3s ease;
	}

	.product-item figure {
		flex-grow: 1;
		/* Giúp phần hình ảnh sản phẩm mở rộng */
		text-align: center;
	}

	.product-item h3 {
		margin: 10px 0;
		font-size: 1.2rem;
		line-height: 1.4;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		/* Giới hạn hiển thị tên sản phẩm tối đa 2 dòng */
		-webkit-box-orient: vertical;
		overflow: hidden;
		text-overflow: ellipsis;
		/* Thêm dấu ba chấm nếu tên sản phẩm quá dài */
	}

	.qty,
	.price {
		margin-bottom: 10px;
	}

	.product-grid .col {
		display: flex;
		justify-content: center;
	}

	.product-item .d-flex {
		justify-content: space-between;
		align-items: center;
		margin-top: auto;
		/* Đẩy phần cuối cùng xuống dưới cùng */
	}
</style>

</html>