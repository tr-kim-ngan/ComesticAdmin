<html lang="en" xmlns:th="http://www.thymeleaf.org">
<section class="py-5" th:fragment="product">
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-12">
				<div class="bootstrap-tabs product-tabs">
					<div class="tabs-header d-flex justify-content-between border-bottom my-5">
						<h3>Sản phẩm hot</h3>
						<nav>
							<div class="nav nav-tabs" id="nav-tab" role="tablist">
								<!-- Tab hiển thị tất cả sản phẩm -->
								<a href="#" class="nav-link text-uppercase fs-6 active" id="nav-all-tab"
									data-bs-toggle="tab" data-bs-target="#nav-all">Tất cả</a>

								<!-- Hiển thị tất cả danh mục sản phẩm -->
								<a href="#" class="nav-link text-uppercase fs-6" th:each="category : ${visibleDanhMucs}"
									th:id="'nav-' + ${category.maDanhMuc} + '-tab'"
									th:data-bs-target="'#nav-' + ${category.maDanhMuc}" th:text="${category.tenDanhMuc}"
									data-bs-toggle="tab"></a>
							</div>
						</nav>
					</div>

					<div class="tab-content" id="nav-tabContent">
						<!-- Hiển thị tất cả sản phẩm -->
						<div class="tab-pane fade show active" id="nav-all" role="tabpanel"
							aria-labelledby="nav-all-tab">
							<div
								class="product-grid row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5">
								<!-- Lặp qua tất cả các sản phẩm và hiển thị -->
								<div class="col" th:each="sanPham : ${sanPhams}"
									style="min-height: 350px; 
									
									
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; 
            transition: transform 0.2s ease, box-shadow 0.3s ease; 
            
            border-radius: 30px; /* Bo góc 10px */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Đổ bóng nhẹ ban đầu */
            background-color: #fff;" 
     onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 16px rgba(0, 0, 0, 0.3)';" 
     onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 6px rgba(0, 0, 0, 0.1)';">
									<div class="product-item" style="flex-grow: 1;">

										<!-- Badge Khuyến mãi -->
										<span class="badge bg-success position-absolute m-3"
											th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
											th:text="'-' + ${sanPhamKhuyenMaiMap[sanPham.maSanPham].phanTramGiamGia} + '%'">
										</span>

										<a href="#" class="btn-wishlist">
											<svg width="24" height="24">
												<use xlink:href="#heart"></use>
											</svg>
										</a>
										<figure>
											<a th:href="@{'/product/' + ${sanPham.maSanPham}}"
												th:title="${sanPham.tenSanPham}">
												<img th:src="@{'/upload/' + ${sanPham.hinhAnh}}" class="tab-image"
													alt="Sản phẩm">
											</a>
										</figure>
										<h3 th:text="${sanPham.tenSanPham}">Tên sản phẩm</h3>
										<span class="qty" th:text="${sanPham.donViTinh.tenDonVi}">Đơn vị tính</span>
										<!--<span class="price" th:text="${sanPham.donGiaBan} + ' VND'">Giá sản phẩm</span>-->
										<!-- Hiển thị giá -->
										<div>

											<!-- Nếu có khuyến mãi, hiển thị giá gốc gạch ngang -->
											<span
												style="font-size: 12px; color: red; text-decoration: line-through; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
												th:text="${sanPham.donGiaBan} + ' VND'">
											</span>

											<!-- Nếu có khuyến mãi và giá sau giảm không null -->
											<span
												style="font-size: 18px; color: black; font-weight: bold; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
												th:text="${sanPhamGiaSauGiamMap[sanPham.maSanPham]} + ' VND'">
											</span>



											<!-- Nếu không có khuyến mãi hoặc không tính được giá sau giảm, hiển thị giá gốc -->
											<span
												style="font-size: 18px; color: black; font-weight: bold; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] == null}"
												th:text="${sanPham.donGiaBan} + ' VND'">
											</span>

										</div>

										<div class="d-flex align-items-center justify-content-between">
											<div class="input-group product-qty">
												<span class="input-group-btn">
													<button type="button"
														class="quantity-left-minus btn btn-danger btn-number"
														data-type="minus">
														<svg width="16" height="16">
															<use xlink:href="#minus"></use>
														</svg>
													</button>
												</span>
												<input type="text" id="quantity" name="quantity"
													class="form-control input-number" value="1">
												<span class="input-group-btn">
													<button type="button"
														class="quantity-right-plus btn btn-success btn-number"
														data-type="plus">
														<svg width="16" height="16">
															<use xlink:href="#plus"></use>
														</svg>
													</button>
												</span>
											</div>
											<a href="#" class="nav-link">Thêm vào giỏ hàng<iconify-icon
													icon="uil:shopping-cart"></iconify-icon></a>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!-- Hiển thị sản phẩm theo từng danh mục -->
						<div class="tab-pane fade" th:each="category : ${visibleDanhMucs}"
							th:id="'nav-' + ${category.maDanhMuc}" role="tabpanel"
							th:aria-labelledby="'nav-' + ${category.maDanhMuc} + '-tab'">
							<div
								class="product-grid row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5">
								<div class="col" th:each="sanPham : ${category.sanPhams}" 
									style="min-height: 350px; 
									
									
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; 
            transition: transform 0.2s ease, box-shadow 0.3s ease; 
            
            border-radius: 30px; /* Bo góc 10px */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Đổ bóng nhẹ ban đầu */
            background-color: #fff;" 
     onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 16px rgba(0, 0, 0, 0.3)';" 
     onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 6px rgba(0, 0, 0, 0.1)';">
									
									
									
									<div class="product-item" style="flex-grow: 1;">
										<!-- Badge Khuyến mãi -->
										<span class="badge bg-success position-absolute m-3"
											th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
											th:text="'-' + ${sanPhamKhuyenMaiMap[sanPham.maSanPham].phanTramGiamGia} + '%'">
										</span>

										<a href="#" class="btn-wishlist">
											<svg width="24" height="24">
												<use xlink:href="#heart"></use>
											</svg>
										</a>
										<figure>
											<a th:href="@{'/product/' + ${sanPham.maSanPham}}"
												th:title="${sanPham.tenSanPham}">
												<img th:src="@{'/upload/' + ${sanPham.hinhAnh}}" class="tab-image"
													alt="Sản phẩm">
											</a>
										</figure>
										<h3 th:text="${sanPham.tenSanPham}">Tên sản phẩm</h3>
										<span class="qty" th:text="${sanPham.donViTinh.tenDonVi}">Đơn vị tính</span>
										<!--<span class="price" th:text="${sanPham.donGiaBan} + ' VND'">Giá sản phẩm</span>-->
										<!-- Hiển thị giá -->
										<div>
											<!-- Nếu có khuyến mãi, hiển thị giá gốc gạch ngang -->
											<span
												style="font-size: 12px; color: red; text-decoration: line-through; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
												th:text="${sanPham.donGiaBan} + ' VND'">
											</span>

											<!-- Nếu có khuyến mãi và giá sau giảm không null -->
											<span
												style="font-size: 18px; color: black; font-weight: bold; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] != null}"
												th:text="${sanPhamGiaSauGiamMap[sanPham.maSanPham]} + ' VND'">
											</span>

											<!-- Nếu không có khuyến mãi, hiển thị giá gốc -->
											<span
												style="font-size: 18px; color: black; font-weight: bold; display: block;"
												th:if="${sanPhamKhuyenMaiMap[sanPham.maSanPham] == null}"
												th:text="${sanPham.donGiaBan} + ' VND'">
											</span>
										</div>


										<div class="d-flex align-items-center justify-content-between">
											<div class="input-group product-qty">
												<span class="input-group-btn">
													<button type="button"
														class="quantity-left-minus btn btn-danger btn-number"
														data-type="minus">
														<svg width="16" height="16">
															<use xlink:href="#minus"></use>
														</svg>
													</button>
												</span>
												<input type="text" id="quantity" name="quantity"
													class="form-control input-number" value="1">
												<span class="input-group-btn">
													<button type="button"
														class="quantity-right-plus btn btn-success btn-number"
														data-type="plus">
														<svg width="16" height="16">
															<use xlink:href="#plus"></use>
														</svg>
													</button>
												</span>
											</div>
											<a href="#" class="nav-link">Thêm vào giỏ hàng<iconify-icon
													icon="uil:shopping-cart"></iconify-icon></a>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>
	</div>
</section>

<style>
	.price {
		font-size: 10px;
		/* Kích thước mặc định cho giá */
		font-weight: bold;
		color: black;
		/* Màu đen cho giá chính */
	}

	.text-danger {
		font-size: 15px;
		/* Kích thước lớn hơn cho giá đã giảm */
		font-weight: bold;
		color: black;
		/* Đổi lại màu đen cho giá sau giảm */
	}

	.text-muted {
		font-size: 6px;
		/* Kích thước nhỏ hơn cho giá gốc */
		color: red;
		/* Màu đỏ cho giá gốc */
		text-decoration: line-through;
		/* Gạch ngang cho giá gốc */
		display: block;
		margin-bottom: 5px;
		/* Khoảng cách giữa giá gốc và giá sau khi giảm */
	}


	/* CSS để đảm bảo các khung sản phẩm đồng đều */
	.product-item {
		display: flex;
		flex-direction: column;
		justify-content: space-between;
		height: 100%;
		/* Đảm bảo khung sản phẩm bao phủ toàn bộ chiều cao */
		border: 1px solid #ddd;
		padding: 10px;
		box-sizing: border-box;
		border-radius: 10px;
		transition: transform 0.3s ease, box-shadow 0.3s ease;
	}

	.product-item figure {
		flex-grow: 1;
		/* Giúp phần hình ảnh sản phẩm mở rộng */
		text-align: center;
	}

	.product-item h3 {
		margin: 10px 0;
		font-size: 1.2rem;
		line-height: 1.4;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		/* Giới hạn hiển thị tên sản phẩm tối đa 2 dòng */
		-webkit-box-orient: vertical;
		overflow: hidden;
		text-overflow: ellipsis;
		/* Thêm dấu ba chấm nếu tên sản phẩm quá dài */
	}

	.qty,
	.price {
		margin-bottom: 10px;
	}

	.product-grid .col {
		display: flex;
		justify-content: center;
	}

	.product-item .d-flex {
		justify-content: space-between;
		align-items: center;
		margin-top: auto;
		/* Đẩy phần cuối cùng xuống dưới cùng */
	}
</style>

</html>